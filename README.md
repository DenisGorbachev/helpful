<!-- DO NOT EDIT -->
<!-- This file is automatically generated by README.ts. -->
<!-- Edit README.ts if you want to make changes. -->

# Better anyhow::Error with a more descriptive error message

[![Build](https://github.com/DenisGorbachev/helpful/actions/workflows/ci.yml/badge.svg)](https://github.com/DenisGorbachev/helpful)
[![Documentation](https://docs.rs/helpful/badge.svg)](https://docs.rs/helpful)

The [`helpful::Error`][__link0] is an upgraded version of [`anyhow::Error`][__link1].
It provides additional information from the current span trace.
This information can be used to diagnose the root cause of the error, which simplifies debugging & provides helpful error messages to the users.

## Compare

### Anyhow

```shell
$ cargo run --quiet --example simple_anyhow -- --config some/non-existent/config.json
Error: No such file or directory (os error 2)
```

No extra information is provided - the user has to guess what went wrong.

### Helpful

```shell
$ cargo run --quiet --example simple_helpful -- --config some/non-existent/config.json
Error: No such file or directory (os error 2)

Call history (recent first):
   0: config::load
           with path="some/non-existent/config.json"
             at examples/simple_helpful.rs:42
   1: cli::run
           with self=Cli { config: "some/non-existent/config.json" }
             at examples/simple_helpful.rs:28
```

Extra information is provided - the user can figure out that the error happened in `config::load` because `some/non-existent/config.json` does not exist.

Note: the examples above assume `RUST_BACKTRACE=0`. If you set `RUST_BACKTRACE=1`, both `anyhow` and `helpful` will display a full backtrace.

## Features

* ✅ Can be propagated up the call stack, just like [`anyhow::Error`][__link2]
* ✅ Can be constructed from existing error types, just like [`anyhow::Error`][__link3]
* ✅ Captures the current tracing span, just like [`tracing_error::TracedError<E>`][__link4]

## Benefits

* Provides a detailed span trace to the user (which makes it easier to diagnose the root cause of the error).
* Provides a detailed span trace to the developer (which simplifies debugging).

## Advantages over [`anyhow::Error`][__link5]

* Provides additional information from the current span trace.

## Advantages over [`tracing_error::TracedError<E>`][__link6]

* Can be propagated up the call stack with `?` operator (no explicit conversion needed). This is because [`helpful::Error`][__link7] doesn’t have any generic arguments, so you can compose the functions that return a [`helpful::Result<T>`][__link8] with the `?` operator. By contrast, [`tracing_error::TracedError<E>`][__link9] is generic over `E`, so you can’t compose the functions that return different `Result<T, TracedError<E>>`.

## Setup

* Initialize the tracing subscriber in `main`
* Ensure the default level is set to `Level::INFO` (or modify your `instrument` attributes to collect the data at another level)

## **Important setup note**

If you don’t see any tracing spans in the error message, check your tracing subscriber configuration. Here’s an example of a correct configuration:

```rust
fn main() {
    init_tracing_subscriber();
    // your code here
}

fn init_tracing_subscriber() {
   use tracing_subscriber::util::SubscriberInitExt;
   use tracing::level_filters::LevelFilter;
   use tracing_error::ErrorLayer;
   use tracing_subscriber::layer::SubscriberExt;

   let env_filter = tracing_subscriber::EnvFilter::builder().with_default_directive(LevelFilter::INFO.into()).from_env_lossy();
   let subscriber = tracing_subscriber::fmt()
       .with_env_filter(env_filter)
       .finish()
       .with(ErrorLayer::default());
   subscriber.init();
}
```

   [__cargo_doc2readme_dependencies_info]: ggGkYW0BYXSEGyMws-dKI-LpG9swkVXG-rikGwSuJGhB0NVbG974QPrPJF6XYXKEG_0b0HUsdiBqG71JWhz8tQKeG38zfrRUuePfG6RkYYOxsnANYWSBgmdoZWxwZnVsZTAuMS4w
 [__link0]: https://docs.rs/helpful/latest/helpful/struct.Error.html
 [__link1]: https://docs.rs/anyhow/latest/anyhow/struct.Error.html
 [__link2]: https://docs.rs/anyhow/latest/anyhow/struct.Error.html
 [__link3]: https://docs.rs/anyhow/latest/anyhow/struct.Error.html
 [__link4]: https://docs.rs/tracing-error/latest/tracing_error/struct.TracedError.html
 [__link5]: https://docs.rs/anyhow/latest/anyhow/struct.Error.html
 [__link6]: https://docs.rs/tracing-error/latest/tracing_error/struct.TracedError.html
 [__link7]: https://docs.rs/helpful/latest/helpful/struct.Error.html
 [__link8]: https://docs.rs/helpful/latest/helpful/type.Result.html
 [__link9]: https://docs.rs/tracing-error/latest/tracing_error/struct.TracedError.html


## Installation

```shell
cargo add helpful tracing_error
```

**Important:** add the `tracing_error` crate too.

## Gratitude

Like the project? [Say thanks!](https://github.com/DenisGorbachev/helpful/discussions/new?category=gratitude) ❤️

## License

[Apache License 2.0](LICENSE-APACHE) or [MIT License](LICENSE-MIT) at your option.

Unless you explicitly state otherwise, any contribution intentionally submitted for inclusion in this crate by you, as defined in the Apache-2.0 license, shall be dual licensed as above, without any additional terms or conditions.
